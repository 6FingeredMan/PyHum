

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>  PyHum</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="PyHum">
<meta property="og:title" content="">


  <link rel="canonical" href="http://dbuscombe-usgs.github.io/PyHum//">
  <meta property="og:url" content="http://dbuscombe-usgs.github.io/PyHum//">



  <meta property="og:description" content="About PyHum">





  

  












  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "PyHum",
      "url" : "http://dbuscombe-usgs.github.io/PyHum/",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="http://dbuscombe-usgs.github.io/PyHum//feed.xml" type="application/atom+xml" rel="alternate" title="PyHum Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://dbuscombe-usgs.github.io/PyHum//assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="http://dbuscombe-usgs.github.io/PyHum//images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="http://dbuscombe-usgs.github.io/PyHum//images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="http://dbuscombe-usgs.github.io/PyHum//images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="http://dbuscombe-usgs.github.io/PyHum//images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="http://dbuscombe-usgs.github.io/PyHum//images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="http://dbuscombe-usgs.github.io/PyHum//images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="http://dbuscombe-usgs.github.io/PyHum//images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="http://dbuscombe-usgs.github.io/PyHum//images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="http://dbuscombe-usgs.github.io/PyHum//images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="http://dbuscombe-usgs.github.io/PyHum//images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="http://dbuscombe-usgs.github.io/PyHum//images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="http://dbuscombe-usgs.github.io/PyHum//images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="http://dbuscombe-usgs.github.io/PyHum//images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="manifest" href="http://dbuscombe-usgs.github.io/PyHum//images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="http://dbuscombe-usgs.github.io/PyHum//images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="http://dbuscombe-usgs.github.io/PyHum//images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="http://dbuscombe-usgs.github.io/PyHum//images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="http://dbuscombe-usgs.github.io/PyHum//assets/css/academicons.css"/>
<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://dbuscombe-usgs.github.io/PyHum//">PyHum</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://dbuscombe-usgs.github.io/PyHum//markdown/">API</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://dbuscombe-usgs.github.io/PyHum//publications/">Publications</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="https://github.com/dbuscombe-usgs/PyHum/blob/master/pyhum_logo_colour.png" alt="Developed by: Daniel Buscombe">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Developed by: Daniel Buscombe</h3>
    <p class="author__bio">Assistant Research Professor</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li><i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> Northern Arizona University</li>
      
      
      
      
        <li><a href="mailto:daniel.buscombe@nau.edu"><i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
      
      
      
      
      
      
      
      
      
      
      
        <li><a href="https://github.com/dbuscombe-usgs"><i class="fa fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
        <li><a href="https://scholar.google.com/citations?user=bwVl0NwAAAAJ&hl=en"><i class="ai ai-google-scholar-square ai-fw"></i> Google Scholar</a></li>
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="">
    <meta itemprop="description" content="About PyHum">
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">
</h1>
          
        
        
        
        
             
        
    
        </header>
      

      <section class="page__content" itemprop="text">
        <p><img src="https://github.com/dbuscombe-usgs/PyHum/blob/master/pyhum_logo_colour.png" alt="logo" /></p>

<p>A Python framework for reading and processing data from a Humminbird low-cost sidescan sonar.</p>

<p>PyHum is an open-source project dedicated to provide a generic Python framework 
for reading and exporting data from Humminbird(R) instruments, carrying out rudimentary radiometric corrections to the data,
classify bed texture, and produce some maps on aerial photos and kml files for google-earth</p>

<p>The software is designed to read Humminbird data (.SON, .IDX, and .DAT files) and works on both sidescan and downward-looking echosounder data, where available.</p>

<h1 id="notes">Notes</h1>

<ul>
  <li>
    <p>This software has been tested with Python 2.7 on various Linux and Windows operating systems. Python 3 is not yet supported</p>
  </li>
  <li>
    <p>This software has (so far) been used only with Humminbird 798, 898, 998, 1198, 1199 and ONIX series instruments.</p>
  </li>
  <li>
    <p>PyHum is not yet compatable with newer HELIX/MEGA systems</p>
  </li>
</ul>

<h1 id="technical-info">Technical Info</h1>
<p>Full documentation of the procedures behind the program is in the following publication:</p>

<blockquote>
  <p>Buscombe, D., 2017, Shallow water benthic imaging and substrate characterization using recreational-grade sidescan-sonar. ENVIRONMENTAL MODELLING &amp; SOFTWARE 89, 1-18.</p>
</blockquote>

<h1 id="credits">Credits</h1>

<table>
  <thead>
    <tr>
      <th>Primary Developer</th>
      <th>Daniel Buscombe</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td>School of Earth Sciences &amp; Environmental Sustainability</td>
    </tr>
    <tr>
      <td> </td>
      <td>Northern Arizona University</td>
    </tr>
    <tr>
      <td> </td>
      <td>Flagstaff, AZ 86001</td>
    </tr>
    <tr>
      <td> </td>
      <td>daniel.buscombe@nau.edu</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Co-Developer</th>
      <th>Daniel Hamill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td>Department of Watershed Sciences</td>
    </tr>
    <tr>
      <td> </td>
      <td>Utah State University</td>
    </tr>
    <tr>
      <td> </td>
      <td>Logan, UT 84322</td>
    </tr>
    <tr>
      <td> </td>
      <td>dhamill@usgs.gov</td>
    </tr>
  </tbody>
</table>

<p>Current version: 1.4.3 (Jan. 2018)</p>

<h1 id="please-cite">Please Cite!</h1>

<p>If you use PyHum in your published work, please cite the following papers:</p>

<ul>
  <li>
    <p>Buscombe, D., Grams, P.E., and Smith, S. (2015) “Automated riverbed sediment classification using low-cost sidescan sonar”, Journal of Hydraulic Engineering, 10.1061/(ASCE)HY.1943-7900.0001079, 06015019.</p>
  </li>
  <li>
    <p>Buscombe, D., 2017, Shallow water benthic imaging and substrate characterization using recreational-grade sidescan-sonar. ENVIRONMENTAL MODELLING &amp; SOFTWARE 89, 1-18.</p>
  </li>
</ul>

<p>For the source code visit <a href="https://github.com/dbuscombe-usgs/PyHum/">the project github site</a></p>

<h1 id="installation">Installation</h1>

<p>Installing in a conda virtual env (recommended)</p>

<p>In a conda (miniconda/anaconda) python 2 environment:</p>

<p>Linux::</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  conda create --name pyhum python=2
  source activate pyhum
  conda install -c conda-forge basemap-data-hires -y
  conda install scipy numpy scikit-image
  pip install simplekml sklearn pandas dask
  pip install joblib toolz cython
  pip install pyresample
  pip install PyHum --no-deps #(or pip install git+https://github.com/dbuscombe-usgs/PyHum.git --no-deps)
  python -c"import PyHum;PyHum.dotest()" 
</code></pre>
</div>

<p>Windows::</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  conda create --name pyhum python=2
  activate pyhum
  conda install -c conda-forge basemap-data-hires -y
  conda install scipy numpy scikit-image
  pip install simplekml sklearn pandas dask
  pip install joblib toolz cython
  pip install pyresample==1.1.4
  pip install PyHum --no-deps #(or pip install git+https://github.com/dbuscombe-usgs/PyHum.git --no-deps)
  python -c"import PyHum;PyHum.dotest()" 
</code></pre>
</div>

<p>Installing as a library accessible outside of virtual env</p>

<p>From PyPI::
<code class="highlighter-rouge">
  pip install PyHum
</code></p>

<p>The latest ‘bleeding edge’ (pre-release) version directly from github::
<code class="highlighter-rouge">
  pip install git+https://github.com/dbuscombe-usgs/PyHum.git
</code></p>

<p>(Windows users) install git from <a href="https://git-scm.com/download/win">here</a></p>

<p>From github repo clone::
<code class="highlighter-rouge">
  git clone git@github.com:dbuscombe-usgs/PyHum.git
  cd PyHum
  python setup.py install
</code></p>

<p>A local installation::
<code class="highlighter-rouge">
  python setup.py install --user
</code></p>

<p>If you get C++ compiler errors (such as “Unable to find vcvarsall.bat”), you will need to install the Microsoft Visual C++ compiler from <a href="http://aka.ms/vcpython27">here</a></p>

<h1 id="installation-on-amazon-linux-ec-2-instance">Installation on Amazon Linux EC-2 instance</h1>

<p>It’s best to install numpy, scipy, cython and matplotlib through the OS package manager::
<code class="highlighter-rouge">
  sudo yum install gcc gcc-c++
  sudo yum install python27-numpy python27-Cython python27-scipy python27-matplotlib
</code></p>

<p>Then install geos libraries using yum and Basemap using pip::
<code class="highlighter-rouge">
  sudo yum install geos geos-devel geos-python27
  sudo pip install basemap --allow-external basemap --allow-unverified basemap
</code></p>

<p>Then PyHum using pip (which will install Pillow, pyproj, simplekml, joblib and scikit-learn)::
<code class="highlighter-rouge">
  sudo pip install PyHum
</code></p>

<h1 id="test">Test</h1>

<p>A test can be carried out by running the supplied script::
<code class="highlighter-rouge">
  python -c "import PyHum; PyHum.test.dotest()"
</code></p>

<h1 id="using-the-gui">Using the GUI</h1>

<p>From the command line (terminal)::</p>

<div class="highlighter-rouge"><pre class="highlight"><code>   python -c "import PyHum; PyHum.gui()"
</code></pre>
</div>

<h1 id="getting-started">Getting Started</h1>

<p>Inputs to the program are a .DAT file (e.g. R0089.DAT) and a folder of .SON and .IDX files (e.g. /my/folder/R0089). The program will read the .SON files with or without the accompanying .IDX files, but will be faster if the .IDX files are present.</p>

<p>PyHum is modular so can be called from within a python or ipython console, from an IDE (such as IDLE or Spyder), or by running a script.</p>

<p>The following example script::</p>

<div class="highlighter-rouge"><pre class="highlight"><code>   import sys, getopt

   from Tkinter import Tk
   from tkFileDialog import askopenfilename, askdirectory

   import PyHum
   import os

   if __name__ == '__main__': 

    argv = sys.argv[1:]
    humfile = ''; sonpath = ''
    
    # parse inputs to variables
    try:
       opts, args = getopt.getopt(argv,"hi:s:")
    except getopt.GetoptError:
         print 'error'
         sys.exit(2)
    for opt, arg in opts:
       if opt == '-h':
         print 'help'
         sys.exit()
       elif opt in ("-i"):
          humfile = arg
       elif opt in ("-s"):
          sonpath = arg

    # prompt user to supply file if no input file given
    if not humfile:
       print 'An input file is required!!!!!!'
       Tk().withdraw() # we don't want a full GUI, so keep the root window from appearing
       humfile = askopenfilename(filetypes=[("DAT files","*.DAT")]) 

    # prompt user to supply directory if no input sonpath is given
    if not sonpath:
       print 'A *.SON directory is required!!!!!!'
       Tk().withdraw() # we don't want a full GUI, so keep the root window from appearing
       sonpath = askdirectory() 

    # print given arguments to screen and convert data type where necessary
    if humfile:
       print 'Input file is %s' % (humfile)

    if sonpath:
       print 'Son files are in %s' % (sonpath)
                 
    doplot = 1 #yes

    # reading specific settings
    cs2cs_args = "epsg:26949" #arizona central state plane
    bedpick = 1 # auto bed pick
    c = 1450 # speed of sound fresh water
    t = 0.108 # length of transducer
    draft = 0.3 # draft in metres
    flip_lr = 1 # flip port and starboard
    model = 998 # humminbird model
    calc_bearing = 0 #no
    filt_bearing = 0 #no
    chunk = 'd100' # distance, 100m
    #chunk = 'p1000' # pings, 1000
    #chunk = 'h10' # heading deviation, 10 deg
     
    # correction specific settings
    maxW = 1000 # rms output wattage
    dofilt = 0 # 1 = apply a phase preserving filter (WARNING!! takes a very long time for large scans)
    correct_withwater = 0 # don't retain water column in radiometric correction (1 = retains water column for radiomatric corrections)
    ph = 7.0 # acidity on the pH scale
    temp = 10.0 # water temperature in degrees Celsius
    #salinity = 0.0

    # for shadow removal
    shadowmask = 1 #manual shadow removal

    # for mapping
    res = 99 # grid resolution in metres
    # if res==99, the program will automatically calc res from the spatial res of the scans
    mode = 1 # gridding mode (simple nearest neighbour)
    #mode = 2 # gridding mode (inverse distance weighted nearest neighbour)
    #mode = 3 # gridding mode (gaussian weighted nearest neighbour)
    dowrite = 0 #disable writing of point cloud data to file

    ## read data in SON files into PyHum memory mapped format (.dat)
    PyHum.read(humfile, sonpath, cs2cs_args, c, draft, doplot, t, bedpick, flip_lr, model, calc_bearing, filt_bearing, chunk) #cog

    ## correct scans and remove water column
    PyHum.correct(humfile, sonpath, maxW, doplot, dofilt, correct_withwater, ph, temp, salinity)

    ## remove acoustic shadows (caused by distal acoustic attenuation or sound hitting shallows or shoreline)
    PyHum.rmshadows(humfile, sonpath, win, shadowmask, doplot)
   
    ## Calculate texture lengthscale maps using the method of Buscombe et al. (2015)
    win = 10
    PyHum.texture2(humfile, sonpath, win, doplot, numclasses)

    ## grid and map the scans
    PyHum.map(humfile, sonpath, cs2cs_args, res, mode, nn, numstdevs, use_uncorrected) #dowrite, 
</code></pre>
</div>

<p>could be saved as, for example “proc_mysidescandata.py” and run from the command line using::</p>

<div class="highlighter-rouge"><pre class="highlight"><code>   python proc_mysidescandata.py -i C:\MyData\R0087.DAT -s C:\MyData\R0087
</code></pre>
</div>

<p>or from within ipython (with a GUI prompt to navigate to the files)::
<code class="highlighter-rouge">
   %run proc_mysidescandata.py
</code></p>

<p>If you are in bash (or git bash) you might want to automate through a folder of subfolders like this::
<code class="highlighter-rouge">
   for k in $(find $PWD -type d -maxdepth 1 -mindepth 1); do python proc_mysidescandata.py -i "$k/${k##*/}.DAT" -s $k; done
</code></p>

<p>which assumes the .DAT file is in the folder with the same root (such as a folder called R00123 which contains SON and IDX files as well as a file called R00123.DAT)</p>

<h1 id="support">Support</h1>

<p>This is a new project written and maintained by Daniel Buscombe. Bugs are expected - please report them, I will fix them quickly. Feedback and suggestions for improvements are <em>very</em> welcome</p>

<p>Please download, try, report bugs, fork, modify, evaluate, discuss, collaborate. Please use the ‘Issues’ tab in github <a href="https://github.com/dbuscombe-usgs/PyHum">here</a></p>

<p>Thanks for stopping by!</p>

<h1 id="trouble-shooting">Trouble Shooting</h1>

<ul>
  <li>
    <p>Problem: pyhum read hangs for a long time (several minutes) on the test script. 
Try this: uninstall joblib and install an older version::
<code class="highlighter-rouge">
 pip uninstall joblib
 pip install joblib==0.7.1
</code></p>
  </li>
  <li>
    <p>Problem: you get an “invalid mode or file name” error.
Try this: construct file paths using raw strings e.g.:: 
<code class="highlighter-rouge">
 r'C:\Users\me\mydata\R0089' 
</code></p>
  </li>
</ul>

<p>or using os, e.g.::
<code class="highlighter-rouge">
   import os
   os.path.abspath(os.path.join('C:\Users','me','mydata','R0089'))
</code></p>

<ul>
  <li>Problem: on Linux, PyHum is using an older version of scipy than 0.16, as revealed by::
<code class="highlighter-rouge">
 python -c 'import scipy;print(scipy.__version__)'
</code></li>
</ul>

<p>Try this: remove a system installed file e.g.::
<code class="highlighter-rouge">
   sudo apt-get remove python-scipy ##(Debian based)
   yum remove scipy ##(Fedora based)
</code></p>

<ul>
  <li>Problem: do I have the latest version of PyHum installed? Check your version using this::
<code class="highlighter-rouge">
 python -c 'import PyHum;print(PyHum.__version__)'
</code></li>
</ul>

<p>Check this against the latest `bleeding-edge’ version <a href="https://github.com/dbuscombe-usgs/PyHum/blob/master/PyHum/__init__.py">here</a> (line 47)</p>


        
      </section>

      <footer class="page__meta">
        
        




      </footer>

      

      


    </div>

    
  </article>

  
  
</div>


    </script>

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<a href="/sitemap/">Sitemap</a>
<!-- end custom footer snippets -->

        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/dbuscombe-usgs"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://dbuscombe-usgs.github.io/PyHum//feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 PyHum. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    <script src="http://dbuscombe-usgs.github.io/PyHum//assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>






  </body>
</html>

